"use strict";(function(){var t=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};this.isObject=function(e){return"object"===t(e)},this.isPlainObject=function(t){return!!t&&"object"==typeof t&&t.constructor===Object},this.isFunction=function(e){return"function"===t(e)},this.isRegexp=function(e){return"regexp"===t(e)},this.isArguments=function(e){return"arguments"===t(e)},this.isError=function(e){return"error"===t(e)},this.isArray=function(e){return"array"===t(e)},this.isDate=function(e){return"date"===t(e)},this.isString=function(e){return"string"===t(e)},this.isNumber=function(e){return"number"===t(e)},this.isBoolean=function(e){return"boolean"===t(e)},this.isElement=function(t){return t&&1===t.nodeType},this.getType=t}).call(window||{}),function(t){var e={},n={},i=function(t){if(!e[t])throw Error("module is undefined");return e[t]},r=function(t,n){if(!e[t])throw Error("module is undefined");return new e[t](n||{})},o=function(t,n){if(e[t])throw Error("module already added");e[t]=n};t.$checkout=function(t,e){return n[t]?n[t]:n[t]=r(t,e)},t.$checkout.get=function(t,e){return r(t,e)},t.$checkout.module=function(t){return i(t)},t.$checkout.proxy=function(t){return i(t).apply(this,Array.prototype.slice.call(arguments,1))},t.$checkout.add=function(t,e){return o(t,e),this},t.$checkout.scope=function(t,e){return o(t,e(this)),this}}(window||{}),$checkout.scope("removeElement",function(){return function(t){t.parentNode.removeChild(t)}}),$checkout.scope("addEvent",function(){return function(t,e,n){if(!t)return!1;t.addEventListener?t.addEventListener(e,n):t.attachEvent&&t.attachEvent("on"+e,n)}}),$checkout.scope("popupBlocker",function(t){return function(t){var e=!1;try{e=void 0===t||(!t||!t.closed)&&(!t||!t.test)}catch(t){}return e}}),$checkout.scope("Class",function(){var t=!1,e=/xyz/.test(function(){return"xyz"}.toString())?/\b_super\b/:/.*/,n=function(){};return n.prototype={instance:function(t){return new this.constructor(t)},proxy:function(t){return t="string"==typeof t?this[t]:t,function(t,e){return function(){return e.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}}(this,t)}},n.extend=function(i){function r(){!t&&this.init&&this.init.apply(this,arguments)}var o,s,a=this.prototype;t=!0,s=new this,t=!1;for(o in i)i.hasOwnProperty(o)&&("function"==typeof a[o]&&"function"==typeof i[o]&&e.test(i[o])?s[o]=function(t,e){return function(){var n,i=this._super;return this._super=a[t],n=e.apply(this,arguments),this._super=i,n}}(o,i[o]):s[o]=i[o]);return r.prototype=s,r.prototype.constructor=n,r.extend=n.extend,r},n}),$checkout.scope("Deferred",function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(e,n){if(t(e))for(var i=0;i<e.length;i++)n(e[i]);else n(e)}function n(i){var r="pending",o=[],s=[],a=[],c=null,u={done:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"resolved"===r&&n[i].apply(this,c),o.push(n[i]);else"resolved"===r&&arguments[e].apply(this,c),o.push(arguments[e]);return this},fail:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"rejected"===r&&n[i].apply(this,c),s.push(n[i]);else"rejected"===r&&arguments[e].apply(this,c),s.push(arguments[e]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"pending"===r&&a.push(n[i]);else"pending"===r&&a.push(arguments[e]);return this},then:function(){return arguments.length>1&&arguments[1]&&this.fail(arguments[1]),arguments.length>0&&arguments[0]&&this.done(arguments[0]),arguments.length>2&&arguments[2]&&this.progress(arguments[2]),this},promise:function(t){if(null===t)return u;for(var e in u)t[e]=u[e];return t},state:function(){return r},debug:function(){console.log("[debug]",o,s,r)},isRejected:function(){return"rejected"===r},isResolved:function(){return"resolved"===r},pipe:function(t,i){return n(function(n){e(t,function(t){"function"==typeof t?h.done(function(){var e=t.apply(this,arguments);e&&"function"==typeof e?e.promise().then(n.resolve,n.reject,n.notify):n.resolve(e)}):h.done(n.resolve)}),e(i,function(t){"function"==typeof t?h.fail(function(){var e=t.apply(this,arguments);e&&"function"==typeof e?e.promise().then(n.resolve,n.reject,n.notify):n.reject(e)}):h.fail(n.reject)})}).promise()}},h={resolveWith:function(t){if("pending"===r){r="resolved";for(var e=c=arguments.length>1?arguments[1]:[],n=0;n<o.length;n++)o[n].apply(t,e)}return this},rejectWith:function(t){if("pending"===r){r="rejected";for(var e=c=arguments.length>1?arguments[1]:[],n=0;n<s.length;n++)s[n].apply(t,e)}return this},notifyWith:function(t){if("pending"===r)for(var e=c=arguments.length>1?arguments[1]:[],n=0;n<a.length;n++)a[n].apply(t,e);return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},l=u.promise(h);return isFunction(i)&&i.apply(l,[l]),l}return n.when=function(){if(arguments.length<2){var t=arguments.length?arguments[0]:void 0;return t&&"function"==typeof t.isResolved&&"function"==typeof t.isRejected?t.promise():n().resolve(t).promise()}return function(t){for(var e=n(),i=t.length,r=0,o=new Array(i),s=0;s<t.length;s++)!function(n){var s=null;t[n].done?t[n].done(function(){o[n]=arguments.length<2?arguments[0]:arguments,++r==i&&e.resolve.apply(e,o)}).fail(function(){e.reject(arguments)}):(s=t[n],t[n]=new Deferred,t[n].done(function(){o[n]=arguments.length<2?arguments[0]:arguments,++r==i&&e.resolve.apply(e,o)}).fail(function(){e.reject(arguments)}).resolve(s))}(s);return e.promise()}(arguments)},n}),$checkout.scope("Event",function(t){return t.module("Class").extend({init:function(){this.events={},this.empty=[]},on:function(t,e){return(this.events[t]=this.events[t]||[]).push(e),this},off:function(t,e){t||(this.events={});for(var n=this.events[t]||this.empty,i=n.length=e?n.length:0;i--;)e===n[i][0]&&n.splice(i,1);return this},trigger:function(t){for(var e,n=this.events[t]||this.empty,i=n.length>0?n.slice(0,n.length):n,r=0;e=i[r++];)e.apply(e,this.empty.slice.call(arguments,1));return this}})}),$checkout.scope("Connector",function(t){return t.module("Class").extend({ns:"crossDomain",origin:"*",uniqueId:1,init:function(t){this.setTarget(t.target),this.create()},create:function(){this.listener=t.get("Event"),t.proxy("addEvent",window,"message",this.proxy("router"))},setTarget:function(t){return this.target=t,this},getUID:function(){return++this.uniqueId},unbind:function(t,e){this.listener.off([this.ns,t].join("."),e)},action:function(t,e){this.listener.on([this.ns,t].join("."),e)},publish:function(t,e){this.listener.trigger([this.ns,t].join("."),e)},router:function(t,e,n){try{n=JSON.parse(e.data)}catch(t){}n.action&&n.data&&this.publish(n.action,n.data)},send:function(t,e){this.target.postMessage(JSON.stringify({action:t,data:e}),this.origin,[])}})}),$checkout.scope("AcsFrame",function(t){return t.module("Class").extend({name:"acsframe",attrs:{frameborder:"0",allowtransparency:"true",scrolling:"no"},styles:{overflowX:"hidden",border:"0",display:"block",width:"100%",height:"750px"},init:function(e){this.checkout=e.checkout,this.data=e.data,this.template=t.views["3ds.html"],this.initModal(),this.initEvents(),this.initFrame(),this.initConnector()},initFrame:function(){this.name=[this.name,Math.round(1e9*Math.random())].join(""),this.wrapper=this.find(".ipsp-modal-content"),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("name",this.name),this.iframe.setAttribute("id",this.name),this.iframe.className="ipsp-modal-iframe",this.addAttr(this.iframe,this.attrs),this.addCss(this.iframe,this.styles),this.form=this.prepareForm(this.data.url,this.data.send_data,this.name),this.wrapper.appendChild(this.iframe),this.wrapper.appendChild(this.form),this.form.submit()},initModal:function(){this.modal=document.createElement("div"),this.modal.innerHTML=this.template,document.querySelector("body").appendChild(this.modal)},find:function(t){return this.modal.querySelector(t)},initEvents:function(){var e=this.find(".ipsp-modal-close"),n=this.find(".ipsp-modal-title a");t.proxy("addEvent",e,"click",this.proxy(function(t,e){e.preventDefault(),this.removeModal()})),t.proxy("addEvent",n,"click",this.proxy(function(t,e){e.preventDefault(),this.form.submit()}))},removeModal:function(){t.proxy("removeElement",this.modal)},prepareForm:function(t,e,n,i){var r,o=document.createElement("form");o.action=t,o.target=n||"_self",o.method=i||"POST";for(var s in e)e.hasOwnProperty(s)&&((r=document.createElement("input")).type="hidden",r.name=s,r.value=e[s],o.appendChild(r));return o.style.display="none",o},initConnector:function(){this.connector=t.get("Connector"),this.connector.action("response",this.proxy(function(t,e){this.connector.unbind("response"),this.checkout.connector.send("request",{uid:e.uid,action:"api.checkout.proxy",method:"send",params:e}),this.removeModal()},this))},addCss:function(t,e){if(!t)return!1;for(var n in e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},addAttr:function(t,e){var n;if(!t)return!1;for(n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n])}})}),$checkout.scope("Model",function(t){return t.module("Class").extend({init:function(t){this.data=t||{}},each:function(){var t,e=arguments,n=e[1]?e[0]:null,i=e[1]?e[1]:e[0],r=n?this.alt(n,[]):this.data;for(t in r)r.hasOwnProperty(t)&&i(this.instance(r[t]),r[t],t)},isPlainObject:function(t){return isPlainObject(t)},isArray:function(t){return isArray(t)},attr:function(t,e){for(var n=0,i=this.data,r=(t||"").split("."),o=r.pop(),s=arguments.length;n<r.length;n++)if(i&&i.hasOwnProperty(r[n]))i=i[r[n]];else{if(2!=s)break;i=i[r[n]]={}}return 1==s?i?i[o]:void 0:(2==s&&(i[o]=e),this)}})}),$checkout.scope("Response",function(t){return t.module("Model").extend({formData:function(t,e,n,i){var r,o=document.createElement("form"),s=document.getElementsByTagName("body")[0];o.action=t,o.target=n||"_self",o.method=i||"POST";for(var a in e)e.hasOwnProperty(a)&&((r=document.createElement("input")).type="hidden",r.name=a,r.value=e[a],o.appendChild(r));return o.style.display="none",{submit:function(){s.appendChild(o),o.submit(),o.parentNode.removeChild(o)}}},redirectUrl:function(){if(this.attr("url"))return location.assign(this.attr("url")),!0},submitForm:function(){var t=this.attr("method"),e=this.attr("url"),n=this.attr("send_data");return this.formData(e,n,"_top",t).submit(),!0},sendResponse:function(){var t=this.attr("action");return"submit"==t?this.submitForm():"redirect"==t&&this.redirectUrl()}})}),$checkout.scope("Form",function(t){return t.module("Class").extend({init:function(t){this.form=t},getData:function(t,e,n){var i=this.deparam(this.serializeAndEncode(),e,!1);return 1==t?this.clean(i):i},clean:function(t){var e;for(e in t)t.hasOwnProperty(e)&&(0===t[e].length?(isArray(t)&&t.splice(e,1),isPlainObject(t)&&delete t[e]):"object"==typeof t[e]&&this.clean(t[e]));return t},map:function(t,e){var n,i,r;if(null==t)throw new TypeError("this is null or not defined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var o=Object(t),s=o.length>>>0;for(arguments.length>1&&(n=arguments[1]),i=new Array(s),r=0;r<s;){var a,c;r in o&&(a=o[r],void 0!==(c=e.call(n,a,r,o))&&(i[r]=c)),r++}return i},serializeArray:function(){var t=Array.prototype.slice.call(this.form.elements);return this.map(t,function(t){if(!t.disabled&&""!=t.name&&(!t.type.match("checkbox|radio")||t.checked))return{name:t.name,value:t.value}})},serializeAndEncode:function(){return this.map(this.serializeArray(),function(t){return[t.name,encodeURIComponent(t.value)].join("=")}).join("&")},deparam:function(t,e,n){var i={},r={true:!0,false:!1,null:null};return n&&(t=t.replace(/\+/g," ")),t.split("&").forEach(function(t){var n,o=t.split("="),s=decodeURIComponent(o[0]),a=i,c=0,u=s.split("]["),h=u.length-1;if(/\[/.test(u[0])&&/\]$/.test(u[h])?(u[h]=u[h].replace(/\]$/,""),h=(u=u.shift().split("[").concat(u)).length-1):h=0,2===o.length)if(n=decodeURIComponent(o[1]),e&&(n=n&&!isNaN(n)&&+n+""===n?+n:"undefined"===n?void 0:void 0!==r[n]?r[n]:n),h)for(;c<=h;c++)a=a[s=""===u[c]?a.length:u[c]]=c<h?a[s]||(u[c+1]&&isNaN(u[c+1])?{}:[]):n;else"[object Array]"===Object.prototype.toString.call(i[s])?i[s].push(n):!{}.hasOwnProperty.call(i,s)?i[s]=n:i[s]=[i[s],n];else s&&(i[s]=e?void 0:"")}),i}})}),$checkout.scope("Api",function(t){return t.module("Class").extend({origin:"https://api.dev.fondy.eu",endpoint:{gateway:"/checkout/v2/"},init:function(){this.loaded=!1,this.created=!1,this.listener=t.get("Event"),this.connector=t.get("Connector"),this.params={}},setOrigin:function(t){return this.origin=t,this},url:function(t,e){return[this.origin,this.endpoint[t]||"/",e||""].join("")},loadFrame:function(t){return this.iframe=document.createElement("iframe"),this.iframe.src=t,this.iframe.style.display="none",document.getElementsByTagName("body")[0].appendChild(this.iframe),this.iframe},create:function(){return!1===this.created&&(this.created=!0,this.iframe=this.loadFrame(this.url("gateway")),this.connector.setTarget(this.iframe.contentWindow),this.connector.action("load",this.proxy("load")),this.connector.action("form3ds",this.proxy("form3ds"))),this},form3ds:function(e,n){this.acsframe=t.get("AcsFrame",{checkout:this,data:n})},load:function(){this.loaded=!0,this.listener.trigger("checkout.api"),this.listener.off("checkout.api")},scope:function(t){t=this.proxy(t),!0===this.create().loaded?t():this.listener.on("checkout.api",t)},defer:function(){return t.get("Deferred")},request:function(e,n,i){var r=this.defer(),o={};return o.uid=this.connector.getUID(),o.action=e,o.method=n,o.params=i||{},this.connector.send("request",o),this.connector.action(o.uid,this.proxy(function(e,n){r[n.error?"rejectWith":"resolveWith"](this,[t.get("Response",n)])},this)),r}})}),$checkout.views=Object.create(null),$checkout.views["3ds.html"]='<style>\n    .ipsp-modal-show{\n        overflow:hidden;\n    }\n    .ipsp-modal{\n        margin:100px auto;\n        max-width:680px;\n        background-color:#fff;\n        border-radius:5px;\n        box-shadow:0px 2px 2px rgba(0,0,0,0.2);\n        overflow: hidden;\n    }\n    @media (max-width:850px){\n        .ipsp-modal{\n            margin:50px auto;\n        }\n    }\n    @media (max-width:695px){\n        .ipsp-modal{\n            max-width:100%;\n            margin:5px;\n        }\n    }\n    .ipsp-modal-wrapper{\n        overflow: auto;\n        position:fixed;\n        z-index:99999;\n        left:0;\n        bottom:0;\n        top:0;\n        right:0;\n        background-color: rgba(0,0,0,0.2);\n    }\n    .ipsp-modal-header{\n        background-color:#fafafa;\n        height:50px;\n        box-shadow:0px 0px 2px rgba(0,0,0,0.2);\n        border-top-left-radius:5px;\n        border-top-right-radius:5px;\n    }\n    .ipsp-modal-close{\n        float:right;\n        overflow:hidden;\n        height:50px;\n        text-decoration:none;\n        border-top-right-radius:5px;\n        color:#949494;\n    }\n    .ipsp-modal-close:hover,.ipsp-modal-close:focus,.ipsp-modal-close:active{\n        text-decoration:none;\n        color:#646464;\n    }\n    .ipsp-modal-close:before{\n        content:"×";\n        font-size:50px;\n        line-height:50px;\n        padding:0 10px;\n    }\n    .ipsp-modal-title{\n        border-top-left-radius:5px;\n        line-height:20px;\n        height:50px;\n        padding:5px 15px;\n        font-size:12px;\n        display:table-cell;\n        vertical-align: middle;\n    }\n    .ipsp-modal-content{\n        border-bottom-left-radius:5px;\n        border-bottom-left-radius:5px;\n        min-height:650px;\n    }\n</style>\n<div class="ipsp-modal-wrapper">\n    <div class="ipsp-modal">\n        <div class="ipsp-modal-header">\n            <a href="#" class="ipsp-modal-close"></a>\n            <div class="ipsp-modal-title">\n                Now you will be redirected to your bank 3DSecure.\n                If you are not redirected please refer\n                <a href=\'javascript:void(0)\'>link</a>\n            </div>\n        </div>\n        <div class="ipsp-modal-content"></div>\n    </div>\n</div>';