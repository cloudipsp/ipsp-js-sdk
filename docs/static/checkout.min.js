!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).$checkout=t()}(function(){return function n(s,o,r){function a(e,t){if(!o[e]){if(!s[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);throw(i=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",i}i=o[e]={exports:{}},s[e][0].call(i.exports,function(t){return a(s[e][1][t]||t)},i,i.exports,n,s,o,r)}return o[e].exports}for(var h="function"==typeof require&&require,t=0;t<r.length;t++)a(r[t]);return a}({1:[function(t,e,i){var n=t("./core/component"),s=t("./core/api"),o=t("./core/connector"),r=t("./core/response"),a=t("./core/payment/button"),h=t("./core/payment/container"),c=t("./core/widget/form"),t=t("./core/widget/button");n.add("Api",s),n.add("Connector",o),n.add("PaymentContainer",h),n.add("PaymentButton",a),n.add("FormWidget",c),n.add("ButtonWidget",t),n.add("Response",r),e.exports=n,e.exports.Api=s,e.exports.Connector=o,e.exports.PaymentContainer=h,e.exports.PaymentButton=a,e.exports.FormWidget=c,e.exports.ButtonWidget=t,e.exports.Response=r},{"./core/api":2,"./core/component":4,"./core/connector":6,"./core/payment/button":13,"./core/payment/container":14,"./core/response":16,"./core/widget/button":19,"./core/widget/form":20}],2:[function(t,e,i){var n=t("./config"),r=t("./deferred"),s=t("./module"),o=t("./connector"),a=t("./modal"),h=t("./response"),s=s.extend({defaults:{origin:"https://api.fondy.eu",endpoint:{gateway:"/checkout/v2/index.html"},messages:{modalHeader:"Now you will be redirected to your bank 3DSecure. If you are not redirected please refer",modalLinkLabel:"link"}},init:function(t){this.initParams(t)},url:function(t,e){return[this.params.origin,this.params.endpoint[t]||"/",e||""].join("")},extendParams:function(t){return this.utils.extend(this.params,t),this},initParams:function(t){this.params=this.utils.extend({},this.defaults),this.extendParams(t),this.setOrigin(this.params.origin),this.loaded=!1,this.created=!1},setOrigin:function(t){return this.utils.isString(t)&&(this.params.origin=t),this},scope:function(t){t=this.proxy(t),!0===this._createFrame().loaded?t():this.on("checkout.api",t)},request:function(t,e,i){var s=r(),o={uid:this.connector.getUID(),action:t,method:e,params:i||{}};return this.connector.send("request",o),this.connector.on(o.uid,this.proxy(function(t,e,i,n){(i=new h(e)).setUID(o.uid),i.setConnector(this.connector),n="resolveWith",i.attr("submit3ds")&&(n="notifyWith"),i.attr("error")&&(n="rejectWith"),s[n](this,[i])})),s},_loadFrame:function(t){return this.iframe=this.utils.createElement("iframe"),this.addAttr(this.iframe,{allowtransparency:!0,frameborder:0,scrolling:"no"}),this.addAttr(this.iframe,{src:t}),this.addCss(this.iframe,n.ApiFrameCss),this.body=this.utils.querySelector("body"),this.body.firstChild?this.body.insertBefore(this.iframe,this.body.firstChild):this.body.appendChild(this.iframe),this.iframe},_createFrame:function(){return!1===this.created&&(this.created=!0,this.iframe=this._loadFrame(this.url("gateway")),this.connector=new o({target:this.iframe.contentWindow}),this.connector.on("load",this.proxy("_onLoadConnector")),this.connector.on("modal",this.proxy("_onOpenModal"))),this},_onOpenModal:function(t,e){this.modal=new a({checkout:this,model:e}),this.modal.on("close",this.proxy("_onCloseModal"))},_onCloseModal:function(t,e){this.trigger("modal.close",t,e)},_onLoadConnector:function(){this.loaded=!0,this.connector.off("load"),this.trigger("checkout.api"),this.off("checkout.api")}});e.exports=s},{"./config":5,"./connector":6,"./deferred":7,"./modal":10,"./module":12,"./response":16}],3:[function(t,e,i){var o=!1,r=/xyz/.test(function(){return"xyz"}.toString())?/\b_super\b/:/.*/;function n(){}function s(t,e){var i,n,s=t.prototype;for(i in o=!0,n=new t,o=!1,e)e.hasOwnProperty(i)&&("function"==typeof s[i]&&"function"==typeof e[i]&&r.test(e[i])?n[i]=function(i,n,s){return function(){var t,e=this._super;return this._super=i[n],t=s.apply(this,arguments),this._super=e,t}}(s,i,e[i]):n[i]=e[i]);return n}n.prototype._super=function(){},n.prototype.instance=function(t){return new this.constructor(t)},n.prototype.proxy=function(t){return t="string"==typeof t?this[t]:t,e=this,i=t,function(){return i.apply(e,[this].concat(Array.prototype.slice.call(arguments)))};var e,i},n.extend=function t(e){function i(){!o&&this.init&&this.init.apply(this,arguments)}return((i.prototype=s(this,e)).constructor=i).extend=t,i},e.exports=n},{}],4:[function(t,e,i){function n(t,e){if(!s[t])throw Error(["module is undefined",t].join(" "));return new s[t](e||{})}var s={},o={};function r(t,e){return o[t]||(o[t]=n(t,e))}r.get=n,r.add=function(t,e){return function(t,e){if(s[t])throw Error(["module already added",t].join(" "));s[t]=e}(t,e),this},e.exports=r},{}],5:[function(t,e,i){i.GooglePayApi="https://pay.google.com/gp/p/js/pay.js",i.GoogleBaseRequest={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["AMEX","DISCOVER","INTERAC","JCB","MASTERCARD","VISA"]}}]},i.GooglePayLanguages=["ar","bg","ca","zh","hr","cs","da","nl","en","et","fi","fr","de","el","id","it","ja","ko","ms","no","pl","pt","ru","sr","sk","sl","es","sv","th","tr","uk"],i.PaymentRequestMethods=[["google",{supportedMethods:["https://google.com/pay"],data:i.GoogleBaseRequest}],["apple",{supportedMethods:["https://apple.com/apple-pay"]}],["card",{supportedMethods:["basic-card"]}]],i.PaymentRequestDetails={total:{label:"Total",amount:{currency:"USD",value:"0.00"}}},i.ApiFrameCss={width:"1px !important",height:"1px !important",left:"1px !important",bottom:"1px !important",position:"fixed !important",border:"0px !important"},i.ButtonFrameCss={border:"none !important",margin:"0 !important",padding:"0 !important",display:"block !important",width:"1px !important","min-width":"100% !important",background:"transparent !important",position:"relative !important",opacity:"0 !important",overflow:"hidden !important",height:"100% !important",outline:"none !important","z-index":"1 !important"},i.ButtonFrameAttrs={tabindex:"-1",scrolling:"no",frameborder:0,allowtransparency:!0,allowpaymentrequest:!0},i.ButtonCoverCss={"z-index":"2 !important",position:"absolute !important",left:"0 !important",top:"0 !important",cursor:"pointer !important",outline:"none !important",width:"100% !important",height:"100% !important"},i.ButtonCoverAttrs={tabindex:"0",href:"javascript:void(0)"},i.ButtonContainerCss={border:"0 !important",margin:"0 !important",padding:"0 !important",display:"block !important",background:"transparent !important",overflow:"hidden !important",position:"relative !important",opacity:"1 !important",height:"0 !important",outline:"none !important"}},{}],6:[function(t,e,i){t=t("./module").extend({ns:"crossDomain",origin:"*",uniqueId:1,signature:null,init:function(t){this.setTarget(t.target),this.create()},create:function(){this.addEvent(window,"message","router")},setTarget:function(t){return this.target=t,this},getUID:function(){return++this.uniqueId},destroy:function(){this.removeEvent(window,"message","router"),this._super()},router:function(t,e,i){if(this.target!==e.source)return!1;try{i=JSON.parse(e.data)}catch(t){}i&&i.action&&i.data&&this.trigger(i.action,i.data)},send:function(t,e){this.target?this.target.postMessage(JSON.stringify({action:t,data:e}),this.origin,[]):console.log(this.target,t,e)}});e.exports=t},{"./module":12}],7:[function(t,e,i){var c=t("./utils");function u(t,e,i){var n,s=0;if(t)if(n=t,c.isArray(n))for(;s<t.length;s++)e.call(i,t[s]);else e.call(i,t)}e.exports=function(t){var e,n=0,s=[],o=[],r=[],a=null,i={done:function(){for(var t=0;t<arguments.length;t++)arguments[t]&&u(arguments[t],function(t){1===n&&t.apply(this,a),s.push(t)},this);return this},fail:function(){for(var t=0;t<arguments.length;t++)arguments[t]&&u(arguments[t],function(t){2===n&&t.apply(this,a),o.push(t)},this);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var t=0;t<arguments.length;t++)arguments[t]&&u(arguments[t],function(t){0===n&&r.push(t)},this);return this},then:function(){return 1<arguments.length&&arguments[1]&&this.fail(arguments[1]),0<arguments.length&&arguments[0]&&this.done(arguments[0]),2<arguments.length&&arguments[2]&&this.progress(arguments[2]),this},promise:function(t){if(null===t)return i;for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t},state:function(){return n},isPending:function(){return 0===n},isRejected:function(){return 2===n},isResolved:function(){return 1===n}},h=i.promise({resolveWith:function(t){if(0===n)for(var e=a=(n=1)<arguments.length?arguments[1]:[],i=0;i<s.length;i++)s[i].apply(t,e);return this},rejectWith:function(t){if(0===n){n=2;for(var e=a=1<arguments.length?arguments[1]:[],i=0;i<o.length;i++)o[i].apply(t,e)}return this},notifyWith:function(t){if(0===n)for(var e=a=1<arguments.length?arguments[1]:[],i=0;i<r.length;i++)r[i].apply(t,e);return this},resetState:function(){return n=0,this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}});return e=t,c.isFunction(e)&&t.call(h,h),h}},{"./utils":18}],8:[function(t,e,i){t=t("./class").extend({init:function(){this.events={},this.empty=[]},on:function(t,e){return(this.events[t]=this.events[t]||[]).push(e),this},off:function(t,e){t||(this.events={});for(var i=this.events[t]||this.empty,n=i.length=e?i.length:0;n--;)e===i[n][0]&&i.splice(n,1);return this},trigger:function(t){for(var e,i=this.events[t]||this.empty,n=0<i.length?i.slice(0,i.length):i,s=0;e=n[s++];)e.apply(e,this.empty.slice.call(arguments,1));return this}});e.exports=t},{"./class":3}],9:[function(t,e,i){var n=t("../deferred"),s=t("../module"),o=t("../config"),s=s.extend({id:"google-payments-api",init:function(){this.client=null,this.wrapper=this.utils.querySelector("head"),this.defer=n()},load:function(){return this.utils.getPath("google.payments.api.PaymentsClient")?this.defer.resolveWith(this):(this.utils.querySelector("#".concat(this.id))||(this.script=this.utils.createElement("script"),this.addAttr(this.script,{id:this.id,async:!0,src:o.GooglePayApi}),this.utils.isElement(this.wrapper)&&this.wrapper.appendChild(this.script),this.addEvent(this.script,"load","onLoadSuccess"),this.addEvent(this.script,"error","onLoadError")),this.defer)},show:function(t){t=t.find(function(t){return"https://google.com/pay"===t.supportedMethods});return this.getClient().loadPaymentData(t.data)},readyToPay:function(t,e){e.result&&this.defer.resolveWith(this)},onError:function(t,e){this.defer.rejectWith(this,e)},onLoadSuccess:function(){this.getClient().isReadyToPay(o.GoogleBaseRequest).then(this.proxy("readyToPay")).catch(this.proxy("onError"))},onLoadError:function(){this.defer.rejectWith(this)},getClient:function(t){var e;return null===this.client&&((e=this.utils.getPath("google.payments.api.PaymentsClient"))?this.client=new e(t):this.onError(null,new Error("Google Client Error"))),this.client}});e.exports=new s},{"../config":5,"../deferred":7,"../module":12}],10:[function(t,e,i){var n=t("./module"),s=t("./connector"),o=t("./template"),n=n.extend({init:function(t){this.checkout=t.checkout,this.model=t.model||{},this.messages=t.checkout.params.messages||{},this.template=new o("3ds.ejs"),this.body=this.utils.querySelector("body"),this.initModal(),this.initConnector()},initModal:function(){this.name=["modal-iframe",this.getRandomNumber()].join("-"),this.modal=this.utils.createElement("div"),this.modal.innerHTML=this.template.render({model:this.model,messages:this.messages}),this.iframe=this.find(".ipsp-modal-iframe"),this.addAttr(this.iframe,{name:this.name,id:this.name}),this.model.send_data?(this.form=this.prepareForm(this.model.url,this.model.send_data,this.name),this.modal.appendChild(this.form)):this.iframe.src=this.model.url,this.addEvent(this.find(".ipsp-modal-close"),"click","closeModal"),this.addEvent(this.find(".ipsp-modal-title a"),"click","submitForm"),this.initScrollbar(),this.body.appendChild(this.modal),this.form&&this.form.submit()},measureScrollbar:function(){var t,e=document.createElement("div");return e.className="modal-scrollbar-measure",this.body.appendChild(e),t=e.offsetWidth-e.clientWidth,this.utils.removeElement(e),t},checkScrollbar:function(){var t,e=(e=window.innerWidth)||(t=document.documentElement.getBoundingClientRect()).right-Math.abs(t.left);this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},initScrollbar:function(){this.checkScrollbar(),this.bodyPad=parseInt(this.utils.getStyle(this.body,"padding-right")||0,10),this.originalBodyPad=document.body.style.paddingRight||"",this.originalOverflow=document.body.style.overflow||"",this.bodyIsOverflowing&&this.addCss(this.body,{paddingRight:[this.bodyPad+this.scrollbarWidth,"px"].join(""),overflow:"hidden"})},resetScrollbar:function(){this.addCss(this.body,{paddingRight:this.originalBodyPad?[this.originalBodyPad,"px"].join(""):"",overflow:this.originalOverflow})},getRandomNumber:function(){return Math.round(1e9*Math.random())},find:function(t){return this.utils.querySelector(t,this.modal)},closeModal:function(t,e){e.preventDefault(),this.trigger("close",this.data),this.removeModal()},submitForm:function(t,e){e.preventDefault(),this.trigger("submit",this.data),this.addAttr(this.form,{target:"_blank"}),this.form.submit()},removeModal:function(){this.destroy()},destroy:function(){this.utils.removeElement(this.modal),this.resetScrollbar(),this.connector.destroy(),this._super()},initConnector:function(){this.connector=new s({target:this.iframe.contentWindow}),this.connector.on("response",this.proxy("onResponse"))},onResponse:function(t,e){this.sendResponse(e),this.removeModal()},sendResponse:function(t){this.checkout.connector.send("request",{uid:t.uid,action:"api.checkout.proxy",method:"send",params:t})}});e.exports=n},{"./connector":6,"./module":12,"./template":17}],11:[function(t,e,i){t=t("./module").extend({init:function(t){this.data=t||{},this.create()},create:function(){},eachProps:function(t){var e=t[1]?t[0]:null,t=t[1]||t[0];return{list:e?this.alt(e,[]):this.data,callback:t}},each:function(){var t,e=this.eachProps(arguments);for(t in e.list)e.list.hasOwnProperty(t)&&e.callback(this.instance(e.list[t]),e.list[t],t)},filter:function(){var t,e,i=this.eachProps(arguments);for(e in i.list)if(i.list.hasOwnProperty(e)&&(t=this.instance(i.list[e]),i.callback(t,i.list[e],e)))return i.list[e]},find:function(){var t,e,i=this.eachProps(arguments);for(e in i.list)if(i.list.hasOwnProperty(e)&&(t=this.instance(i.list[e]),i.callback(t,i.list[e],e)))return t;return!1},alt:function(t,e){return void 0===(t=this.attr(t))?e:t},attr:function(t,e){for(var i=0,n=this.data,s=(t||"").split("."),o=s.pop(),r=arguments.length;i<s.length;i++)if(n&&n.hasOwnProperty(s[i]))n=n[s[i]];else{if(2!==r)break;n=n[s[i]]={}}return 1===r?n?n[o]:void 0:(2===r&&(n[o]=e),this)},stringify:function(){return JSON.stringify(this.serialize())},serialize:function(){return this.data}});e.exports=t},{"./module":12}],12:[function(t,e,i){var n=t("./class"),s=t("./event"),t=t("./utils"),t=n.extend({utils:t,getListener:function(){return this._listener_||(this._listener_=new s),this._listener_},destroy:function(){this.off()},on:function(t,e){return this.getListener().on(t,e),this},off:function(t,e){return this.getListener().off(t,e),this},proxy:function(t){return this._proxy_cache_||(this._proxy_cache_={}),this.utils.isString(t)?(this._proxy_cache_[t]||(this._proxy_cache_[t]=this._super(t)),this._proxy_cache_[t]):this._super(t)},trigger:function(){return this.getListener().trigger.apply(this.getListener(),arguments),this},each:function(t,e){this.utils.forEach(t,this.proxy(e))},addAttr:function(i,t){if(!this.utils.isElement(i))return!1;this.utils.forEach(t,function(t,e){i.setAttribute(e,t)})},addCss:function(i,t){if(!this.utils.isElement(i))return!1;this.utils.forEach(t,function(t,e){this.addCssProperty(i,e,t)},this)},addCssProperty:function(t,e,i){var n,s=t.style.cssText.match(new RegExp("(?:[;\\s]|^)("+e.replace("-","\\-")+"\\s*:(.*?)(;|$))"));s?(n=s.index+s[0].indexOf(s[1]),t.style.cssText=t.style.cssText.substring(0,n)+e+": "+i+";"+t.style.cssText.substring(n+s[1].length)):t.style.cssText+=" "+e+": "+i+";"},addEvent:function(t,e,i){if(!t||!e||!i)return!1;i=this.proxy(i),t.addEventListener?t.addEventListener(e,i):t.attachEvent&&t.attachEvent("on"+e,i)},removeEvent:function(t,e,i){if(!t||!e||!i)return!1;i=this.proxy(i),t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i)},prepareForm:function(t,e,i,n){var s=this.utils.createElement("form");return this.addAttr(s,{action:t,target:i||"_self",method:n||"POST"}),this.addCss(s,{display:"none"}),this.utils.forEach(e,function(t,e,i){(i=this.utils.createElement("input")).type="hidden",i.name=e,i.value=t,s.appendChild(i)},this),s}});e.exports=t},{"./class":3,"./event":8,"./utils":18}],13:[function(t,e,i){var n=t("../config"),s=t("../module"),o=t("../api"),r=t("../connector"),a=t("../response"),h=t("../deferred"),c=t("./request"),s=s.extend({defaults:{origin:"https://api.fondy.eu",endpoint:{gateway:"/checkout/v2/index.html",button:"/checkout/v2/button/index.html"},style:{height:38,mode:"default",type:"long",color:"black"},data:{}},init:function(t){this.initParams(t),this.initElement(),this.initEvents(),this.initApi(),this.initFrame(),this.initPaymentRequest()},initParams:function(t){this.supported=!1,this.params=this.utils.extend({},this.defaults,t)},initApi:function(){this.params.api instanceof o?(this.api=this.params.api,delete this.params.api):this.api=new o({origin:this.params.origin,endpoint:this.params.endpoint})},endpointUrl:function(t,e){return[this.params.origin,this.params.endpoint[t]||"/",e||""].join("")},initElement:function(){this.element=this.utils.querySelector(this.params.element),this.container=this.utils.createElement("div"),this.cover=this.utils.createElement("a"),this.addCss(this.cover,n.ButtonCoverCss),this.addAttr(this.cover,n.ButtonCoverAttrs),this.addCss(this.container,n.ButtonContainerCss),this.element.appendChild(this.container)},sendButtonEvent:function(t,e){e.preventDefault(),this.connector.send("event",{type:e.type})},initEvents:function(){this.addEvent(this.cover,"mouseenter","sendButtonEvent"),this.addEvent(this.cover,"mouseleave","sendButtonEvent"),this.addEvent(this.cover,"blur","sendButtonEvent"),this.addEvent(this.cover,"focus","sendButtonEvent"),this.addEvent(this.cover,"click","onClick")},initPaymentRequest:function(){this.payment=new c({}),this.payment.on("complete",this.proxy("onToken")),this.payment.on("error",this.proxy("onError")),this.payment.on("log",this.proxy("onLog")),this.payment.on("supported",this.proxy("onSupported")),this.payment.on("fallback",this.proxy("onFallback")),this.payment.on("reload",this.proxy("onReload")),this.payment.setApi(this.api),this.payment.setMerchant(this.params.data.merchant_id),this.payment.getSupportedMethod()},initFrame:function(){this.frameLoaded=h(),this.frame=this.utils.createElement("iframe"),this.addCss(this.frame,n.ButtonFrameCss),this.addAttr(this.frame,n.ButtonFrameAttrs),this.addAttr(this.frame,{src:this.endpointUrl("button")}),this.container.appendChild(this.frame),this.container.appendChild(this.cover),this.initConnector(),this.addEvent(this.frame,"load",function(){this.frameLoaded.resetState().resolve()})},onFrameLoaded:function(){this.update({})},onFallback:function(){this.fallback=!0,this.payment.fallback(this.proxy(function(){this.onSupported(null,"google")}))},onSupported:function(t,e){this.supported=!0,this.method=e,this.frameLoaded.done(this.proxy("onFrameLoaded"))},initConnector:function(){this.connector=new r({target:this.frame.contentWindow}),this.connector.on("show",this.proxy("onShow")),this.connector.on("hide",this.proxy("onHide")),this.connector.on("log",this.proxy("onLog")),this.connector.on("pay",this.proxy("onPay")),this.connector.on("complete",this.proxy("onToken")),this.connector.on("error",this.proxy("onError")),this.connector.on("reload",this.proxy("onReload"))},getConfigParams:function(t){var e={method:this.method,data:{},style:{},fallback:this.fallback};return this.utils.extend(e.data,this.params.data),this.utils.extend(e.style,this.params.style),this.utils.isPlainObject(t)&&this.utils.extend(e,t),e},send:function(t,e){return!0===this.supported&&this.connector.send(t,e),this},update:function(t){this.sendOptions(t),this.api.scope(this.proxy(function(){this.api.request("api.checkout.pay","get",this.params.data).done(this.proxy("sendConfig")).fail(this.proxy("sendConfig"))}))},sendOptions:function(t){this.utils.extend(this.params,this.getConfigParams(t)),this.send("options",this.params)},sendConfig:function(t,e){this.model=e,this.model.supportedMethod(this.method),this.payment.setConfig(this.model.data),this.send("config",this.model.data)},callback:function(t){var e=this.utils.extend({},this.params.data,t.serialize());this.api.scope(this.proxy(function(){this.api.request("api.checkout.form","request",e).done(this.proxy("onSuccess")).fail(this.proxy("onError"))}))},process:function(t){return this.callback=t,this},validate:function(e){var i;this.validateCallback=(i=this,function(t){if(!0===i.validationProgress)return!1;i.validationProgress=!0,e(function(){i.validationProgress=!1,t.call(i)})})},cssUnit:function(t,e){return String(t||0).concat(e||"").concat(" !important")},onClick:function(){this.validateCallback?this.validateCallback(function(){this.payment.pay()}):this.payment.pay()},onToken:function(t,e){this.callback(new a(e))},onSuccess:function(t,e){this.trigger("success",e)},onError:function(t,e){this.trigger("error",e)},onReload:function(t,e){this.trigger("reload",e)},onShow:function(){this.addCss(this.frame,{transition:"opacity 0.6s 0.4s ease-out",opacity:this.cssUnit(1)}),this.addCss(this.container,{transition:"height 0.2s ease-out",height:this.cssUnit(this.params.style.height,"px")}),this.trigger("show",{})},onHide:function(){this.addCss(this.frame,{transition:"opacity 0.4s ease-out",opacity:this.cssUnit(0)}),this.addCss(this.container,{transition:"height 0.2s 0.4s ease-out",height:this.cssUnit(0,"px")}),this.trigger("hide",{})},onLog:function(t,e){this.trigger("log",{event:"log",result:e})}});e.exports=s},{"../api":2,"../config":5,"../connector":6,"../deferred":7,"../module":12,"../response":16,"./request":15}],14:[function(t,e,i){var s=t("../config"),n=t("../module"),o=t("../connector"),r=t("./request"),n=n.extend({defaults:{element:null,method:"card",data:{lang:"en"},style:{}},init:function(t){this.initParams(t),this.initEvents()},initParams:function(t){this.params=this.utils.extend({},this.defaults,t),this.element=this.utils.querySelector(this.params.element),this.connector=new o({target:window.parent}),this.payment=new r({embedded:!0})},extendParams:function(t){this.utils.extend(this.params,{method:t.method,style:t.style,data:t.data,css:t.css})},addFrameImage:function(){var t,e=this.utils.querySelector("iframe",this.element)||this.utils.createElement("iframe"),i=this.params.style||{},n=(t=this.params.data.lang,n="en",-1!==s.GooglePayLanguages.indexOf(t)?t:n),n={buttonColor:i.color||"black",browserLocale:n,buttonSizeMode:"fill"},n=["https://pay.google.com/gp/p/generate_gpay_btn_img",this.utils.param(n)].join("?");this.addAttr(e,{scrolling:"no",frameborder:0,src:n}),this.element.appendChild(e),this.element.classList.remove("short","long")},styleButton:function(){var i=this.element,t=this.params.method,e=this.params.style||{},n=this.params.data.lang||"en",s=this.params.css||{};i.setAttribute("class",""),i.classList.add("button","pending"),(t="card"===t?"google":t)&&i.classList.add(t),n&&i.classList.add(n),e.type&&i.classList.add(e.type),e.mode&&i.classList.add(e.mode),e.color&&i.classList.add(e.color),s&&this.utils.forEach(s,function(t,e){i.style.setProperty(["--",e].join(""),t)}),"google"===t&&"default"===e.mode&&this.addFrameImage()},initEvents:function(){this.payment.on("complete",this.proxy(function(t,e){this.connector.send("complete",e)})),this.payment.on("reload",this.proxy(function(t,e){this.connector.send("reload",e)})),this.payment.on("error",this.proxy(function(t,e){this.connector.send("error",e)})),this.connector.on("options",this.proxy(function(t,e){this.extendParams(e),this.styleButton()})),this.connector.on("config",this.proxy(function(t,e){this.payment.setConfig(e).isValidConfig()?(this.element.classList.remove("pending"),this.element.classList.add("ready"),this.connector.send("show",{})):this.connector.send("hide",{})})),this.connector.on("event",this.proxy(function(t,e){"mouseenter"===e.type&&this.element.classList.add("hover"),"mouseleave"===e.type&&this.element.classList.remove("hover"),"focus"===e.type&&this.element.classList.add("active"),"blur"===e.type&&this.element.classList.remove("active")}))}});e.exports=n},{"../config":5,"../connector":6,"../module":12,"./request":15}],15:[function(t,e,i){function r(t,e,i){var n=null;if(i=i||{},(e=e||{}).id=h.uuid(),window.hasOwnProperty("PaymentRequest")&&"function"==typeof window.PaymentRequest)try{n=new PaymentRequest(t,e,i)}catch(t){n=null}return n}var s=t("../api"),n=t("../module"),o=t("../google/pay"),a=t("../deferred"),h=t("../utils"),c=t("../config"),n=n.extend({config:{payment_system:"",fallback:!1,methods:[],details:{},options:{}},init:function(t){this.params=t||{}},setConfig:function(t){return this.config=t,this},setMerchant:function(t){this.merchant=t},setApi:function(t){t instanceof s&&(this.api=t)},isValidConfig:function(){return this.config.payment_system&&this.config.methods&&0<this.config.methods.length},getSupportedMethod:function(){!function(e,i,n){var s,o=arguments.callee,t=i[n]||!1;if(!1===t)return e.trigger("fallback");n=(n||0)+1,s=t[0],t=t[1],(t=r([t],c.PaymentRequestDetails))?t.canMakePayment().then(function(t){!0===t?e.trigger("supported",s):o(e,i,n)}):o(e,i,n)}(this,c.PaymentRequestMethods,0)},modelRequest:function(t,e,i,n){this.api instanceof s&&this.api.scope(this.proxy(function(){this.api.request("api.checkout.pay",t,e).done(this.proxy(i)).fail(this.proxy(n))}))},getRequest:function(){var e=this,i=a(),t=r(this.config.methods,this.config.details,this.config.options);return t?(this.addEvent(t,"merchantvalidation","merchantValidation"),t.canMakePayment().then(function(){t.show().then(function(t){t.complete("success").then(function(){i.resolveWith(e,[t.details])})}).catch(function(t){i.rejectWith(e,[{code:t.code,message:t.message}])})}).catch(function(t){i.rejectWith(e,[{code:t.code,message:t.message}])})):o.show(this.config.methods).then(function(t){i.resolveWith(e,[t])}).catch(function(t){i.rejectWith(e,[{code:t.code,message:t.message}])}),i},fallback:function(t){o.load().then(t)},pay:function(){this.getRequest().done(function(t){this.trigger("complete",{payment_system:this.config.payment_system,data:t})}).fail(function(t){this.trigger("error",t),!0===this.params.embedded&&(location.reload(),this.trigger("reload",this.params))})},appleSession:function(t){var i=a();return this.modelRequest("session",t,function(t,e){i.resolveWith(this,[e.serialize()])},function(t,e){i.rejectWith(this,[e])}),i},merchantValidation:function(t,e){this.appleSession({url:e.validationURL,domain:location.host,merchant_id:this.merchant}).done(function(t){try{e.complete(t.data)}catch(t){this.trigger("error",t)}}).fail(function(t){this.trigger("error",t)})}});e.exports=n},{"../api":2,"../config":5,"../deferred":7,"../google/pay":9,"../module":12,"../utils":18}],16:[function(t,e,i){var t=t("./model"),s="http://secure-redirect.cloudipsp.com/submit/",t=t.extend({stringFormat:function(t){var i=this;return(t||"").replace(/{(.+?)}/g,function(t,e){return i.attr(["order.order_data",e].join("."))||t})},setConnector:function(t){return this.connector=t,this},setUID:function(t){return this.uid=t,this},getUID:function(){return this.uid},formDataProxy:function(t,e,i,n){location.assign([s,JSON.stringify({url:t,params:e,target:i,method:n})].join("#"))},formDataSubmit:function(t,e,i,n){if(t.match(/^http:/))return this.formDataProxy(t,e,i,n);t=this.stringFormat(t),n=this.prepareForm(t,e,i,n);this.utils.querySelector("body").appendChild(n),n.submit(),n.parentNode.removeChild(n)},inProgress:function(){return this.attr("order.in_progress")},readyToSubmit:function(){return this.attr("order.ready_to_submit")},waitForResponse:function(){return this.attr("order.pending")},needVerifyCode:function(){return this.attr("order.need_verify_code")},redirectUrl:function(){return!!this.attr("url")&&(location.assign(this.attr("url")),!0)},submitToMerchant:function(){var t=this.attr("order.ready_to_submit"),e=this.attr("model.url")||this.attr("order.response_url"),i=this.attr("order.method"),n=this.attr("model.send_data")||this.attr("order.order_data");if(t&&e&&n)return this.formDataSubmit(e,n,"_self",i),!0},submitForm:function(){var t=this.attr("method"),e=this.attr("url"),i=this.attr("send_data");return!(!e||!i)&&(this.formDataSubmit(e,i,"_self",t),!0)},sendResponse:function(){var t=this.attr("action");return"submit"===t?this.submitForm():"redirect"===t&&this.redirectUrl()},prepare3dsData:function(){var t={},e=this.attr("submit3ds");return e["3ds"]&&(t.token=this.attr("token"),t.uid=this.getUID(),t.frame=!0,e.send_data.TermUrl&&(e.send_data.TermUrl=[e.send_data.TermUrl,this.utils.param(t)].join("#!!"))),e},waitOn3dsDecline:function(){var t=this.alt("submit3ds.checkout_data",{js_wait_on_3ds_decline:!1,js_wait_on_3ds_decline_duration:0});return t.js_wait_on_3ds_decline?t.js_wait_on_3ds_decline_duration:0},submit3dsForm:function(){this.attr("submit3ds.checkout_data")&&this.connector.trigger("modal",this.prepare3dsData())},supportedMethod:function(e){var t=this.find("methods",function(t){return t.alt("supportedMethods","").match(e)});t&&this.attr("methods",[t.serialize()])}});e.exports=t},{"./model":11}],17:[function(t,e,i){function n(t){return null==t?"":(""+t).replace(a,function(t){return r[t]})}var s=t("../views"),o=t("./class"),t=t("./utils"),h={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},c=/(.)^/,u={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},d=/\\|'|\r|\n|\t|\u2028|\u2029/g,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},a=new RegExp("[&<>\"']","g"),l=0,t=o.extend({utils:t,init:function(t){this.name=t,this.view={},this.output()},output:function(){this.view.source=s[this.name],this.view.output=function(o){var e,t=new RegExp([(h.escape||c).source,(h.interpolate||c).source,(h.evaluate||c).source].join("|")+"|$","g"),r=0,a="__p+='";o.replace(t,function(t,e,i,n,s){return a+=o.slice(r,s).replace(d,function(t){return"\\"+u[t]}),e&&(a+="'+\n((__t=("+e+"))==null?'':escapeExpr(__t))+\n'"),i&&(a+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),n&&(a+="';\n"+n+"\n__p+='"),r=s+t.length,t}),a+="';\n",a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(a=!h.variable?"with(obj||{}){\n"+a+"}\n":a)+"return __p;\n//# sourceURL=/tmpl/source["+l+++"]";try{e=new Function(h.variable||"obj","escapeExpr",a)}catch(t){throw t.source=a,t}t=function(t){return e.call(this,t,n)};return t.source="function("+(h.variable||"obj")+"){\n"+a+"}",t}(this.view.source)},render:function(t){return this.data=t,this.view.output.call(this,this)},include:function(t,e){return this.instance(t).render(this.utils.extend(this.data,e))}});e.exports=t},{"../views":22,"./class":3,"./utils":18}],18:[function(t,e,i){var o={getType:function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},isObject:function(t){return"object"===this.getType(t)},isPlainObject:function(t){return!!t&&"object"==typeof t&&t.constructor===Object},isFunction:function(t){return"function"===this.getType(t)},isRegexp:function(t){return"regexp"===this.getType(t)},isArguments:function(t){return"arguments"===this.getType(t)},isError:function(t){return"error"===this.getType(t)},isArray:function(t){return"array"===this.getType(t)},isDate:function(t){return"date"===this.getType(t)},isString:function(t){return"string"===this.getType(t)},isNumber:function(t){return"number"===this.getType(t)},isElement:function(t){return t&&1===t.nodeType},toArray:function(t){return[].slice.call(t)},querySelectorAll:function(t,e){return this.toArray((e||document).querySelectorAll(t))},querySelector:function(t,e){return(e||document).querySelector(t)},hasProp:function(t,e){return t&&t.hasOwnProperty(e)},forEach:function(t,e,i){for(var n in t)this.hasProp(t,n)&&e.call(i||null,t[n],n)},map:function(t,e,i){var n,s,o=[];for(n in t)this.hasProp(t,n)&&void 0!==(s=e.call(i||null,t[n],n))&&(o[n]=s);return o},cleanObject:function(t){for(var e in t)this.hasProp(t,e)&&(0===t[e].length?(this.isArray(t)&&t.splice(e,1),this.isPlainObject(t)&&delete t[e]):this.isPlainObject(t[e])&&this.cleanObject(t[e]));return t},param:function(t){function e(t,e){e=null==(e="function"==typeof e?e():e)?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)}var i=[],s=function(n,t){return n?o.isArray(t)?o.forEach(t,function(t,e){var i;s(n+"["+(i=e,"object"==typeof(e=t)&&e?i:"")+"]",t)}):o.isObject(t)?o.forEach(t,function(t,e){s(n+"["+e+"]",t)}):e(n,t):o.isArray(t)?o.forEach(t,function(t){e(t.name,t.value)}):o.forEach(t,function(t,e){s(e,t)}),i};return s("",t).join("&")},removeElement:function(t){t.parentNode.removeChild(t)},createElement:function(t){return document.createElement(t)},getStyle:function(t,e,i){return((i=window.getComputedStyle)?i(t):t.currentStyle)[e.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()})]},extend:function(i){return this.forEach([].slice.call(arguments,1),function(t){null!==t&&this.forEach(t,function(t,e){this.isPlainObject(t)?i[e]=this.extend(i[e]||{},t):i[e]=t},this)},this),i},uuid:function(){for(var t=0,e="";t++<36;)e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-";return e},getPath:function(t){var e=t.split("."),t=e.shift(),i=null;return this.hasProp(window,t)&&(i=window[t],this.forEach(e,function(t){i=this.hasProp(i,t)?i[t]:null},this)),i}};e.exports=o},{}],19:[function(t,e,i){t=t("./index").extend({attributes:{},initElement:function(t){this.utils.isPlainObject(this.params.attributes)&&this.utils.extend(this.attributes,this.params.attributes),this.addSelectorEvent(t,"click","sendRequest")},getRequestParams:function(t){return this.utils.extend({},this.params.options,this.getElementData(t))},getElementData:function(i){var n={};return this.utils.forEach(this.attributes,function(t,e){i.hasAttribute(e)&&(n[t]=i.getAttribute(e))}),n}});e.exports=t},{"./index":21}],20:[function(t,e,i){var n=t("../module"),t=t("./index"),s=n.extend({init:function(t){this.setFormElement(t)},setFormElement:function(t){this.utils.isElement(t)&&(this.form=t)},getData:function(t){var e=this.deparam(this.serializeArray());return!0===t?this.utils.cleanObject(e):e},serializeArray:function(){var t=this.utils.toArray(this.form.elements);return this.utils.map(t,function(t){if(!t.disabled&&""!==t.name&&(!t.type.match("checkbox|radio")||t.checked))return{name:t.name,value:t.value}})},serializeAndEncode:function(){return this.utils.map(this.serializeArray(),function(t){return[t.name,encodeURIComponent(t.value)].join("=")}).join("&")},deparam:function(t){var e,r={},i=/[^\[\]]+|\[\]$/g;for(e in t)t.hasOwnProperty(e)&&function(t,e){for(var i=r,n=t.pop(),s=t.length,o=0;o<s;o++)i[t[o]]||(i[t[o]]=s===o+1&&"[]"===n?[]:{}),i=i[t[o]];"[]"===n?i.push(e):i[n]=e}(t[e].name.match(i),t[e].value);return r}}),t=t.extend({initElement:function(t){this.addSelectorEvent(t,"submit","sendRequest")},getRequestParams:function(t){return this.utils.extend({},this.params.options,new s(t).getData())}});e.exports=t},{"../module":12,"./index":21}],21:[function(t,e,i){t=t("../api").extend({init:function(t){this.initParams(t),this.initWidget()},initWidget:function(){this.initOptions(this.params.options),this.utils.isString(this.params.element)&&this.initElement(this.params.element)},initOptions:function(){this.utils.isPlainObject(this.params.options)&&(this.params.options=this.params.options||{})},initElement:function(t){},addSelectorEvent:function(t,i,n){return this.each(this.utils.querySelectorAll(t),function(t,e){this.addEvent(e,i,n)}),this},getRequestParams:function(){return{}},sendRequest:function(t,e){e.defaultPrevented||(e.preventDefault(),this.trigger("request",this.getRequestParams(t)),this.scope(function(){this.request("api.checkout.form","request",this.getRequestParams(t)).done(this.proxy("onSuccess")).fail(this.proxy("onError")).progress(this.proxy("onProgress"))}))},onProgress:function(t,e){this.trigger("progress",e)},onSuccess:function(t,e){e.sendResponse(),e.submitToMerchant(),this.trigger("success",e)},onError:function(t,e){this.trigger("error",e)}});e.exports=t},{"../api":2}],22:[function(t,e,i){e.exports=Object.create(null),e.exports["3ds.ejs"]='<%=include(\'styles.ejs\')%>\n<div class="ipsp-modal-wrapper">\n    <div class="ipsp-modal">\n        <div class="ipsp-modal-header">\n            <a href="javascript:void(0)" class="ipsp-modal-close"></a>\n            <div class="ipsp-modal-title">\n                <%-data.messages.modalHeader%>\n                <a href=\'javascript:void(0)\'><%-data.messages.modalLinkLabel%></a>\n            </div>\n        </div>\n        <div class="ipsp-modal-content">\n            <iframe src="about:blank" class="ipsp-modal-iframe" frameborder="0" allowtransparency="true"></iframe>\n        </div>\n    </div>\n</div>\n\n',e.exports["styles.ejs"]='<style>\n    .ipsp-modal{\n        box-sizing: border-box;\n        margin:100px auto;\n        max-width:680px;\n        background-color:#fff;\n        border-radius:5px;\n        box-shadow:0 2px 2px rgba(0,0,0,0.2);\n        overflow: hidden;\n    }\n    @media (max-width:850px){\n        .ipsp-modal{\n            margin:50px auto;\n        }\n    }\n    @media (max-width:695px){\n        .ipsp-modal{\n            max-width:100%;\n            margin:5px;\n        }\n    }\n    .ipsp-modal-wrapper{\n        box-sizing: border-box;\n        overflow: auto;\n        position:fixed;\n        z-index:99999;\n        left:0;\n        bottom:0;\n        top:0;\n        right:0;\n        background-color: rgba(0,0,0,0.2);\n    }\n    .ipsp-modal-header{\n        box-sizing: border-box;\n        background-color:#fafafa;\n        height:50px;\n        box-shadow:0 0 2px rgba(0,0,0,0.2);\n        border-top-left-radius:5px;\n        border-top-right-radius:5px;\n    }\n    .ipsp-modal-close{\n        box-sizing: border-box;\n        float:right;\n        overflow:hidden;\n        height:50px;\n        text-decoration:none;\n        border-top-right-radius:5px;\n        color:#949494;\n    }\n    .ipsp-modal-close:hover,.ipsp-modal-close:focus,.ipsp-modal-close:active{\n        text-decoration:none;\n        color:#646464;\n    }\n    .ipsp-modal-close:before{\n        content:"×";\n        font-size:50px;\n        line-height:50px;\n        padding:0 10px;\n    }\n    .ipsp-modal-title{\n        box-sizing: border-box;\n        border-top-left-radius:5px;\n        line-height:20px;\n        height:50px;\n        padding:5px 15px;\n        font-size:12px;\n        display:table-cell;\n        vertical-align: middle;\n    }\n    .ipsp-modal-content{\n        box-sizing: border-box;\n        border-bottom-left-radius:5px;\n        min-height:650px;\n    }\n    .ipsp-modal-iframe{\n        overflow-x: hidden;\n        border: 0;\n        display: block;\n        width: 100%;\n        height: 750px;\n    }\n\n</style>\n',e.exports["trustly.ejs"]='<%=include(\'styles.ejs\')%>\n<div class="ipsp-modal-wrapper">\n    <div class="ipsp-modal">\n        <div class="ipsp-modal-header">\n            <a href="#" class="ipsp-modal-close"></a>\n            <div class="ipsp-modal-title">\n                <%-data.messages.modalHeader%>\n                <a href=\'javascript:void(0)\'><%-data.messages.modalLinkLabel%></a>\n            </div>\n        </div>\n        <div class="ipsp-modal-content">\n            <iframe src="about:blank" class="ipsp-modal-iframe" frameborder="0" allowtransparency="true"></iframe>\n        </div>\n    </div>\n</div>\n'},{}]},{},[1])(1)});
//# sourceMappingURL=checkout.min.js.map
